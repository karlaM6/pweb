<div class="container">
  <h1>âœ¨ Crear Nueva Partida</h1>

  <ng-container *ngIf="jugador() as j; else sinJugador">
    <div class="jugador-info">
      <span class="icono">ğŸ‘¤</span>
      <div>
        <strong>Jugador:</strong>
        <p>{{ j.nombre }}</p>
      </div>
    </div>

    <form class="form-partida">
      <!-- SelecciÃ³n de Mapa -->
      <div class="form-section">
        <h2>ğŸ—ºï¸ Selecciona un Mapa</h2>
        <div class="grid-mapas">
          <ng-container *ngIf="mapas().length > 0; else noMapas">
            <div *ngFor="let mapa of mapas()" class="card-mapa"
                 [class.seleccionado]="mapaSeleccionado() === mapa.id"
                 (click)="mapaSeleccionado.set(mapa.id!)">
              <div class="card-header">
                <span class="badge-mapa">Mapa #{{ mapa.id }}</span>
              </div>
              <div class="card-body">
                <div class="dimensiones">{{ mapa.filas }} x {{ mapa.columnas }}</div>
                <div class="info-celdas">{{ mapa.celdas?.length || 0 }} celdas</div>
              </div>
              <div *ngIf="mapaSeleccionado() === mapa.id" class="check-seleccionado">âœ“</div>
            </div>
          </ng-container>
          <ng-template #noMapas>
            <div class="mensaje-vacio">
              <p>No hay mapas disponibles</p>
              <a *ngIf="auth.isAdmin()" routerLink="/mapa/create" class="link-crear">Crear nuevo mapa</a>
            </div>
          </ng-template>
        </div>
      </div>

      <!-- SelecciÃ³n de Barco -->
      <div class="form-section">
        <h2>ğŸš¢ Selecciona tu Barco</h2>
        <div class="grid-barcos">
          <ng-container *ngIf="barcos().length > 0; else noBarcos">
            <div *ngFor="let barco of barcos()" class="card-barco"
                 [class.seleccionado]="barcoSeleccionado() === barco.id"
                 (click)="barcoSeleccionado.set(barco.id!)">
              <div class="card-header">
                <span class="nombre-barco">{{ barco.nombre }}</span>
              </div>
              <div class="card-body">
                <div class="stats">
                  <div class="stat">
                    <span class="label">Vel. X:</span>
                    <span class="value">{{ barco.velocidadX }}</span>
                  </div>
                  <div class="stat">
                    <span class="label">Vel. Y:</span>
                    <span class="value">{{ barco.velocidadY }}</span>
                  </div>
                </div>
              </div>
              <div *ngIf="barcoSeleccionado() === barco.id" class="check-seleccionado">âœ“</div>
            </div>
          </ng-container>
          <ng-template #noBarcos>
            <div class="mensaje-vacio">
              <p>No tienes barcos disponibles</p>
              <a *ngIf="auth.isAdmin()" routerLink="/barco/create" class="link-crear">Crear nuevo barco</a>
            </div>
          </ng-template>
        </div>
      </div>

      <!-- Botones -->
      <div class="acciones">
        <button
          type="button"
          class="btn btn-primary"
          (click)="crearPartida()"
          [disabled]="!mapaSeleccionado() || !barcoSeleccionado()">
          ğŸš€ Crear Partida
        </button>
        <button type="button" class="btn btn-secondary" (click)="cancelar()">
          â† Volver
        </button>
      </div>
    </form>
  </ng-container>

  <ng-template #sinJugador>
    <div class="mensaje-vacio">
      <p>No se encontrÃ³ el jugador. Por favor, selecciona un jugador primero.</p>
    </div>
  </ng-template>
</div>
